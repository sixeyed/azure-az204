# Service Bus Publish-Subscribe - AZ-204 Exam Relevance Script

## Overview

Let's talk about how Service Bus topics and the publish-subscribe pattern relate to the AZ-204 exam: Developing Solutions for Microsoft Azure.

## Exam Domain: Develop Message-Based Solutions

Service Bus topics fall under the "Develop message-based solutions" section of the exam, which typically accounts for 10-15% of the questions. This is a crucial area because messaging is fundamental to building scalable, decoupled cloud applications.

## Key Exam Topics Covered

### 1. Understanding Message-Based Architecture Patterns

The exam expects you to understand the difference between queuing and pub-sub patterns:

- **Queues** are for point-to-point communication - one sender, one receiver
- **Topics** are for publish-subscribe - one or more senders, multiple subscribers where each gets a copy

You should be able to identify scenarios where each pattern is appropriate. For example:
- Use queues for task distribution where each task should be processed once
- Use topics for event distribution where multiple components need to react to the same event

### 2. Service Bus Tier Selection

This is important for the exam. You need to know:
- **Basic tier**: Supports only queues, maximum message size 256 KB
- **Standard tier**: Supports both queues and topics, message size up to 256 KB
- **Premium tier**: Enhanced performance, message size up to 100 MB, virtual network integration

The exam may present scenarios where you need to choose the appropriate tier based on requirements.

### 3. Topics and Subscriptions

For the exam, understand these concepts:

**Topics**:
- Destinations for publishers to send messages
- Support multiple subscriptions
- Messages are forwarded to all subscriptions
- Can configure time-to-live and maximum size

**Subscriptions**:
- Act as independent queues receiving copies of topic messages
- Each subscription maintains its own message state
- Can have filters and rules (which we'll cover in advanced labs)
- Support multiple concurrent receivers

### 4. Authorization and Security

The exam tests your knowledge of securing Service Bus resources:

- **Shared Access Signatures (SAS)**: Authorization rules with specific rights (Send, Listen, Manage)
- **Principle of least privilege**: Creating specific policies for publishers and subscribers
- **Connection strings**: Understanding how to retrieve and use them securely
- **Azure Active Directory integration**: For more advanced scenarios

In our lab, we created separate authorization rules for publishers (Send rights) and subscribers (Listen rights). This is a best practice you should remember for the exam.

### 5. Message Time-to-Live (TTL)

Understanding TTL is crucial:
- Can be set at the topic level (default for all messages)
- Can be overridden per message
- Prevents old messages from accumulating
- Uses ISO 8601 duration format

The exam might ask you to configure TTL for specific business requirements, like:
- "Messages should expire after 30 minutes if not processed"
- "Keep messages available for 24 hours"

### 6. Working with Azure CLI

The exam includes questions about Azure CLI commands. You should be familiar with:

```
az servicebus namespace create
az servicebus topic create
az servicebus topic subscription create
az servicebus topic authorization-rule create
```

You don't need to memorize exact syntax, but you should understand the command structure and what parameters are available.

### 7. Application Development

The exam may include code questions about:

- Using the Azure.Messaging.ServiceBus SDK
- Sending messages to topics (same code as sending to queues)
- Receiving messages from subscriptions (requires both topic name and subscription name)
- Proper disposal of clients and processors
- Error handling and retry logic

## Common Exam Scenarios

Here are types of questions you might encounter:

**Scenario 1**: "Your application needs to send order notifications that multiple services need to process independently. Each service should receive all notifications. Which Service Bus entity should you use?"
- **Answer**: Service Bus topic with a subscription for each service

**Scenario 2**: "You need to implement a messaging solution where messages expire after 15 minutes if not processed. How do you configure this?"
- **Answer**: Set default-message-time-to-live when creating the topic or queue

**Scenario 3**: "A publisher application needs to send messages to a Service Bus topic. What is the minimum permission required?"
- **Answer**: Send rights on the topic

**Scenario 4**: "You have three services that need to process order events. Each service processes at a different speed. How do you ensure each service can process at its own pace?"
- **Answer**: Create three subscriptions on the topic, one for each service

## Design Patterns for the Exam

Be familiar with these architectural patterns:

1. **Fan-out**: One publisher sends to multiple subscribers via a topic
2. **Competing consumers**: Multiple receivers on the same subscription for load balancing
3. **Message filtering**: Using subscription rules to route specific messages (advanced topic)
4. **Dead-letter queues**: Handling messages that can't be processed

## Performance and Scaling Considerations

The exam may ask about:
- **Partitioning**: For higher throughput (Premium tier)
- **Message batching**: Sending multiple messages in one operation
- **Prefetching**: Improving receiver performance
- **Session handling**: For ordered message processing

## Monitoring and Troubleshooting

Know how to:
- Check message counts in subscriptions
- Use Azure Portal's Service Bus Explorer
- Query subscription properties with Azure CLI
- Understand message states (active, dead-lettered, scheduled)

## Key Takeaways for the Exam

1. Topics are for pub-sub, queues are for point-to-point
2. Standard tier or higher is required for topics
3. Each subscription gets a copy of every message
4. Use separate authorization rules for send and listen operations
5. TTL prevents message accumulation
6. Multiple receivers on one subscription compete for messages
7. Multiple receivers on different subscriptions each get all messages

## Practice Recommendations

To prepare for Service Bus questions on the exam:
- Practice creating topics and subscriptions via CLI and Portal
- Write code to send and receive messages
- Experiment with different authorization configurations
- Understand when to use topics vs. queues
- Review the official Microsoft Learn modules on Service Bus

Remember, the AZ-204 exam is scenario-based. You won't just need to know facts - you'll need to apply them to solve real-world problems. This lab gives you hands-on experience with the patterns and practices you'll see on the exam.
