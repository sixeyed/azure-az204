Excellent work implementing secure AKS networking! This lab addresses multiple AZ-204 exam domains, so let's focus on what you need to know for the certification.

This topic spans several exam domains: implementing containerized solutions with AKS, using Azure security services like managed identities and Key Vault, securing Azure services with network rules, and integrating services together. It represents a production-ready pattern that's frequently tested in scenario questions, so understanding it thoroughly will help you across multiple parts of the exam.

Managed identity authentication is heavily tested material that you need to understand deeply. AKS clusters have a system-assigned managed identity that can authenticate to other Azure services without storing any credentials. You need to know how to grant this identity access to Key Vault using access policies, and understand why this is more secure than using service principals with passwords. The exam will present scenarios where you need to choose the most secure authentication method, and managed identity is almost always the right answer.

Key Vault integration patterns appear in multiple exam scenarios with different approaches. The exam tests three primary methods to access Key Vault from containers: using the CSI driver to mount secrets as files in the container filesystem, using direct SDK access where application code calls the Key Vault API, and using App Service configuration for automatic injection into environment variables. You need to know when to use each approach and understand their tradeoffs. For AKS, the CSI driver is preferred because it requires no application code changes.

Network security with service endpoints is a critical exam topic that comes up repeatedly. You must understand that service endpoints provide a secure, private path between VNets and Azure services without going over the public internet. Know the difference between service endpoints, which provide per-service VNet integration at no extra charge, and private endpoints, which give you a dedicated private IP address but require Private Link and have additional costs. The exam loves questions about when to use each option based on cost and security requirements.

Azure CNI versus kubenet networking appears in AKS scenario questions. Azure CNI gives each pod its own VNet IP address, which is required for service endpoints, but it consumes more IP addresses from your VNet. Kubenet uses an overlay network where pods get IPs from a separate CIDR range, which is more IP-efficient but doesn't support service endpoints. Scenario questions will test which networking mode to choose based on IP address availability, service endpoint requirements, and scale requirements.

Key Vault access policies need to be thoroughly understood. Know how to grant GET and LIST permissions for secrets using the set-policy command. Understand the difference between access policies and Azure RBAC, since Key Vault supports both authorization systems. Remember that access policies are per-identity, granting specific permissions to specific identities, while network rules are per-source-network, controlling where requests can originate from regardless of who's making them.

Storage account network rules work similarly to Key Vault network rules. You can restrict storage accounts to only allow access from specific VNets and subnets using service endpoints. The exam may ask about securing multi-tier applications where both Key Vault and Storage Accounts need subnet restrictions.

The CSI driver architecture is tested in questions about how secrets get into containers. Understand that the CSI driver runs as a DaemonSet on each node, creates a volume that contains the secret content, and mounts that volume into your pod. The application just reads a file, completely unaware of Key Vault.

Troubleshooting access issues is important for scenario questions. Know how to diagnose problems with managed identity permissions, network rule blocks, and RBAC assignments. Common issues include forgetting to grant the managed identity permission, not enabling service endpoints on the subnet, or incorrect network rules that block access.

Throughout our review, we'll work through common exam scenarios about securing multi-service applications, choosing authentication methods, and implementing network restrictions. This is one of the most comprehensive security patterns on the exam, so master it!
