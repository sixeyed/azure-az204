# Securing AKS Apps with Key Vault and Virtual Networks - AZ-204 Exam Relevance

## Exam Domain Coverage

This lab addresses several key areas of the AZ-204 certification exam. Let me walk through how each concept maps to exam objectives.

## Develop for Azure Compute - Container Solutions

The AZ-204 exam expects you to understand how to deploy and manage containerized solutions on Azure. Specifically, you should know:

How to deploy container instances and container apps to Azure
How to configure container settings and environment
How to manage container identity and security

In this lab, we're deploying containers to Azure Kubernetes Service, which is Azure's managed Kubernetes offering. While the exam may focus more on Azure Container Instances and Container Apps, the security concepts here - like managed identity and secrets management - apply across all container services.

## Implement Azure Security - Managed Identities

Managed identities are a critical exam topic. You need to understand:

The difference between system-assigned and user-assigned managed identities
How to configure managed identity for Azure services
How to use managed identity to access other Azure resources
How to grant permissions to managed identities

In this lab, we used a managed identity that's created by the AKS KeyVault Secrets Provider add-on. This is a user-assigned managed identity. We granted it access to Key Vault using an access policy, demonstrating the end-to-end pattern of identity-based authentication without credential management.

For the exam, remember that managed identities eliminate the need to store credentials in code or configuration. The authentication token is obtained automatically by the Azure platform.

## Implement Azure Security - Key Vault

Key Vault is heavily tested on AZ-204. You must know how to:

Create and configure Key Vault instances
Store and retrieve secrets, keys, and certificates
Configure access policies and RBAC for Key Vault
Integrate Key Vault with applications and services
Implement Key Vault references in App Service and Functions

This lab demonstrated several of these skills:

We created a Key Vault using the Azure CLI
We stored a secret from a file
We configured access policies to grant the AKS managed identity get permissions
We restricted network access using virtual network rules
We used the KeyVault Secrets Provider to mount secrets into Kubernetes Pods

The exam may ask you to write code that accesses Key Vault using the Azure SDK, but understanding the configuration and security model is equally important.

## Implement Azure Security - Network Security

Network security is part of the security implementation domain. You should understand:

How to configure virtual networks and subnets
How to implement network security groups and service endpoints
How to secure Azure services using virtual network integration
How to configure private endpoints

In this lab, we used service endpoints to secure both Key Vault and Storage Account. Service endpoints allow traffic from your VNet to reach Azure services over the Microsoft backbone network, while allowing those services to identify and filter traffic based on the source subnet.

The key commands we used were:

Enabling service endpoints on the subnet
Adding network rules to allow specific subnets
Setting the default action to Deny to block all other traffic

For the exam, understand the difference between service endpoints and private endpoints. Service endpoints are subnet-level, while private endpoints give you a private IP address for the service inside your VNet.

## Connect to and Consume Azure Services - Storage

Storage Accounts are fundamental to many AZ-204 scenarios. You need to know:

How to create and configure storage accounts
How to work with blobs, files, queues, and tables
How to secure storage using access keys, SAS tokens, and managed identity
How to configure storage firewalls and network rules
How to use connection strings and endpoints

This lab covered storage security specifically. We:

Created a storage account and blob container
Retrieved the connection string
Stored the connection string securely in Key Vault
Configured network rules to restrict access to the AKS subnet

The exam expects you to know multiple ways to authenticate to storage - access keys, shared access signatures, and managed identity. Our lab used a connection string with an access key, which provides full access to the storage account. In production, you'd want to use either managed identity or time-limited SAS tokens for better security.

## Connect to and Consume Azure Services - API Management

While this lab doesn't directly use API Management, there's a related concept worth mentioning. When deploying APIM to a VNet, you can configure it to use internal or external mode, similar to how we deployed AKS into a VNet.

APIM can also integrate with Key Vault to retrieve values like backend service credentials, certificates, or named values. The pattern of using managed identity to access Key Vault applies here as well.

## Kubernetes on Azure

Although Kubernetes itself isn't a primary AZ-204 topic, the exam does cover container orchestration through Azure Container Apps, which is built on Kubernetes and KEDA. Understanding basic Kubernetes concepts helps:

Pods are the smallest deployable units
Services expose Pods on the network
Deployments manage replica sets of Pods
ConfigMaps and Secrets provide configuration

The Secrets Store CSI Driver we used is a Kubernetes-native way to integrate with external secret stores. It mounts secrets as volumes, making them available to applications as files. This pattern is cleaner than using environment variables because secrets aren't exposed in Pod specifications.

## Real-World Application

The scenario in this lab represents a production-ready security pattern. When deploying applications to Azure, you should:

Use managed identities instead of storing credentials
Store secrets in Key Vault, not in code or environment variables
Restrict network access to sensitive resources using VNet integration
Apply the principle of least privilege for all access grants
Layer multiple security controls for defense in depth

These aren't just exam topics - they're Azure best practices that you'll use in real-world solutions.

## Common Exam Question Patterns

Based on this lab, here are question patterns you might see on the exam:

Scenario: An application in AKS needs to access Key Vault. What's the most secure authentication method?
Answer: Use the AKS managed identity with Key Vault access policies

Scenario: You need to prevent Key Vault access from the Internet. What should you configure?
Answer: Enable service endpoints on the VNet subnet and configure Key Vault network rules with default action Deny

Scenario: An app needs database connection strings. Where should you store them?
Answer: In Azure Key Vault secrets, accessed via managed identity

Scenario: What's required for AKS Pods to get IP addresses from a VNet subnet?
Answer: Use the Azure CNI network plugin and specify the vnet-subnet-id when creating the cluster

## Study Recommendations

To reinforce these concepts for the exam:

Practice creating Key Vaults and managing secrets via CLI and code
Work with managed identities across different Azure services
Understand the difference between access policies and RBAC for Key Vault
Know how to configure service endpoints and network rules
Be able to write code that accesses Key Vault using the Azure SDK
Understand connection string formats for storage and databases

The hands-on experience from this lab gives you practical knowledge that will help you answer scenario-based questions on the exam.

## Summary

This lab touched on critical AZ-204 exam domains:

Azure compute through containerized solutions
Security through managed identities and Key Vault
Networking through virtual networks and service endpoints
Storage security and connectivity

The pattern demonstrated here - using managed identity to access Key Vault secrets from a VNet-integrated service - is one you'll see repeatedly across Azure services and exam questions. Master this pattern, and you'll be well-prepared for the security and integration portions of the AZ-204 exam.
