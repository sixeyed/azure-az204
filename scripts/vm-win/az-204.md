# Virtual Machines - Windows - AZ-204 Exam Exercises

Virtual Machines appear in the AZ-204 exam under the Infrastructure as a Service domain, which typically accounts for a portion of your exam score. While the exam tends to focus more heavily on Platform as a Service offerings like App Service and Container Instances, understanding when and how to use Virtual Machines is essential for comprehensive Azure solution design. The exam tests not just your ability to provision VMs, but your understanding of when IaaS is appropriate versus PaaS alternatives.

## Prerequisites

You should be comfortable with the Azure CLI and basic VM concepts before tackling these exam-focused exercises. Understanding resource groups, networking fundamentals, and storage types will help you work through these scenarios more effectively. These advanced exercises assume you've completed the basic VM lab and are ready to explore the features and decisions that appear in AZ-204 exam questions.

## AZ-204 Exam Skills Covered

The exam expects you to demonstrate competency across several VM-related areas. You'll need to understand VM provisioning through code using Azure CLI, PowerShell, or ARM templates rather than just portal-based creation. Selecting appropriate VM sizes based on workload requirements is crucial because cost optimization appears frequently in exam scenarios. Storage configuration including OS disks versus data disks and choosing between Standard and Premium storage tiers tests your architectural decision-making. Network configuration for VMs including security groups, public IP addresses, and virtual network integration ensures you can design secure and accessible solutions. Understanding authentication models for both Windows and Linux VMs, including SSH keys versus username and password combinations, addresses security best practices. Finally, you must grasp cost management concepts like VM deallocation versus deletion and the ongoing costs of storage even when VMs aren't running.

## VM Provisioning and Configuration

The AZ-204 exam tests your ability to provision VMs programmatically rather than through the portal. Understanding the az vm create command and its required parameters is fundamental because exam questions often present code snippets with missing or incorrect parameters that you need to identify.

The image parameter specifies which operating system to install and follows the URN format with four components - publisher, offer, SKU, and version separated by colons. For example, MicrosoftWindowsDesktop is the publisher for Windows client operating systems, windows-11 might be the offer, win11-22h2-pro could be the SKU, and you can specify either a version number or "latest" for the most recent build. Understanding this structure helps you answer questions about selecting appropriate images for specific scenarios.

Size selection requires knowing the VM size families and their intended workloads. The D-series represents general-purpose VMs that balance compute, memory, and network resources suitable for most applications. The F-series provides compute-optimized VMs with higher CPU-to-memory ratios perfect for compute-intensive workloads. The E-series offers memory-optimized configurations with high memory-to-CPU ratios ideal for databases and in-memory analytics. The B-series provides burstable VMs that accumulate credits during idle periods and can burst above baseline performance when needed, making them cost-effective for workloads with variable usage patterns.

Windows VMs have specific requirements that differ from Linux VMs. Authentication uses username and password combinations rather than SSH keys, though Windows Server versions can support SSH if configured. The default incoming port is 3389 for Remote Desktop Protocol instead of port 22 for SSH. Windows VMs typically require larger sizes than Linux because the Windows operating system itself consumes more resources. Understanding these differences helps you answer comparison questions on the exam.

The location parameter determines which Azure region hosts your VM, affecting latency for end users, compliance with data residency requirements, and service availability since not all VM sizes exist in all regions. The exam may present scenarios where you need to choose regions based on these factors.

## VM Images and URN Structure

Understanding how to find and select appropriate VM images appears frequently in AZ-204 exam questions. The az vm image list commands let you query available images, and knowing how to filter these results is crucial for exam success.

The az vm image list-offers command shows available offers from a specific publisher in a specific region. This helps you discover what operating system families are available. The az vm image list-skus command shows specific SKUs within an offer, revealing different editions or versions like Windows 11 Pro versus Enterprise. The az vm image list-all command shows every version of a specific SKU, useful when you need reproducibility with a specific build or want to see patch release history.

Using "latest" as the version component ensures you always get the most recent security-patched image, which is generally recommended for production workloads. However, specifying an exact version provides reproducibility if you need to ensure all VMs are absolutely identical. The exam tests your understanding of when each approach is appropriate.

Custom images represent VMs you've configured and captured for reuse. This approach allows you to pre-install applications and configurations, reducing deployment time for new instances. The exam may present scenarios about custom images versus cloud-init scripts versus VM extensions for application deployment.

## VM Storage Management

Storage architecture for VMs is a significant exam topic because it affects both performance and cost. Understanding the difference between OS disks and data disks is fundamental to proper VM design.

The OS disk contains the operating system and system files, automatically created when you provision a VM. For Windows VMs this becomes the C drive. The OS disk typically gets deleted when you delete the VM because it's specific to that instance. The size of the OS disk depends on the image you selected, with Windows requiring larger OS disks than most Linux distributions.

Data disks provide additional storage that can persist independently from the VM lifecycle. You can create data disks when provisioning the VM or attach them later. Data disks can be detached from one VM and attached to another, making them useful for portable data or shared storage scenarios. When you delete a VM, you can choose to retain data disks, making them a good choice for application data that should survive VM replacement.

Disk SKUs determine performance characteristics and cost. Standard HDD provides the lowest cost per gigabyte but also the lowest performance, suitable for backups, archives, or development workloads where performance isn't critical. Standard SSD offers better performance than HDD at moderate cost, appropriate for web servers and lightly used applications. Premium SSD provides high performance with low latency and high IOPS, necessary for databases and production applications with intensive disk I/O. Ultra Disk delivers the highest performance with configurable IOPS and throughput, designed for the most demanding workloads like SAP HANA.

The exam frequently tests cost optimization scenarios. Deallocating a VM stops compute charges but you still pay for disk storage. This is important to understand because candidates often assume deallocated VMs are completely free. Premium disks cost significantly more than Standard disks, so choosing the right tier based on actual performance requirements rather than defaulting to Premium can substantially reduce costs.

Disk caching options affect performance for specific workload types. None means no caching, appropriate for write-heavy workloads. ReadOnly caches read operations, beneficial for workloads that frequently read the same data. ReadWrite caches both operations, useful for general-purpose workloads. The exam may ask you to select appropriate caching for described scenarios.

## Network Security and Access

Network configuration for VMs appears extensively in AZ-204 exam questions because proper network design is fundamental to security and accessibility.

Network Security Groups act as virtual firewalls controlling inbound and outbound traffic. NSG rules specify the source, destination, port, and protocol to allow or deny. Rules have priority numbers where lower numbers are processed first, and once a rule matches, processing stops. Understanding rule priority and how to design effective security rules is essential for the exam.

Inbound port configuration determines what external traffic can reach your VM. Port 3389 for RDP access to Windows VMs must be open for remote management but should be restricted to trusted IP addresses in production scenarios. Port 22 for SSH access to Linux VMs follows the same security considerations. Application ports like 80 for HTTP and 443 for HTTPS need to be open for web applications. The exam tests your ability to configure appropriate rules for described scenarios while following security best practices.

Public IP addresses can be static or dynamic. Dynamic IPs change when you deallocate and restart a VM, problematic if you've configured DNS or firewall rules based on that IP. Static IPs remain the same across deallocation cycles but cost slightly more. The exam may present scenarios where you need to choose between these options.

Virtual networks provide private networking for your Azure resources. VMs in the same VNet can communicate using private IP addresses without traversing the internet. Subnets within VNets let you segment your network and apply different security rules to different tiers. Understanding when to use VNets versus public IPs for inter-VM communication helps you design secure architectures.

## VM Sizing and Performance

Selecting appropriate VM sizes is a common exam question type because it requires understanding workload requirements and translating them to VM specifications.

The numberOfCores parameter determines CPU resources. Applications that parallelize work benefit from more cores, while single-threaded applications may perform better with fewer faster cores. The exam presents scenarios with specific CPU requirements, and you need to select VMs that meet those needs.

The memoryInMb parameter specifies RAM. Memory-intensive applications like databases, caching systems, and analytics workloads require large amounts of RAM. The exam tests your ability to convert memory requirements from gigabytes to megabytes and select appropriate VMs.

VM size families optimize for different workload types. General-purpose sizes balance resources for typical applications. Compute-optimized sizes provide high CPU-to-memory ratios for batch processing, web servers, and network appliances. Memory-optimized sizes offer high memory-to-RAM ratios for relational databases and in-memory analytics. Storage-optimized sizes provide high disk throughput for big data and databases. GPU sizes include specialized hardware for machine learning and graphics rendering.

The exam frequently includes cost optimization questions. Larger VMs cost more per hour, so selecting the smallest VM that meets your requirements reduces costs. However, choosing too small a VM can degrade performance and user experience. The exam tests your ability to find this balance based on described requirements.

Azure Spot VMs offer significant discounts by using spare Azure capacity, but they can be evicted when Azure needs the capacity back. The exam may ask when Spot VMs are appropriate, and the answer typically involves fault-tolerant workloads like batch processing, development environments, or stateless applications where interruption is acceptable.

## Cost Management Considerations

Understanding VM costs is crucial for the AZ-204 exam because cost optimization appears frequently in scenario-based questions.

Compute costs accrue whenever a VM is running. Stopping a VM from within the operating system doesn't stop these charges because the VM is still allocated in Azure's infrastructure. You must deallocate the VM using Azure management tools to stop compute charges. The exam tests whether you understand this distinction.

Storage costs continue regardless of VM state. Both OS disks and data disks incur charges even when the VM is deallocated or deleted unless you explicitly delete the disks. This is important for cost optimization scenarios where you need to reduce spending for non-production environments.

Premium disk costs are significantly higher than Standard disks, and costs increase with disk size. Choosing appropriate disk tiers based on actual performance requirements rather than always using Premium can substantially reduce costs. The exam presents scenarios where you need to balance performance requirements with cost constraints.

Data transfer costs apply when data moves between regions or out of Azure to the internet. Keeping VMs and their data in the same region minimizes transfer costs. The exam may include questions about designing architectures that minimize these costs.

## Integration with Other Azure Services

VMs rarely exist in isolation, and the AZ-204 exam tests your knowledge of how VMs integrate with other Azure services to create complete solutions.

Azure Key Vault provides secure storage for secrets like VM passwords, SSH keys, and encryption keys. Instead of embedding credentials in scripts or configuration files, applications on VMs can authenticate to Key Vault and retrieve secrets at runtime. This pattern appears in exam questions about securing credential access.

Azure Monitor and Log Analytics provide observability for your VMs. The Azure Monitor agent collects metrics and logs from VMs and sends them to centralized storage. Log Analytics lets you query this data for troubleshooting and analysis. The exam may ask about monitoring solutions for described scenarios.

Azure Backup provides automated backup and restore for VM disks. You can configure backup schedules and retention policies, and restore entire VMs or individual files. Understanding when to use Azure Backup versus manual snapshots helps you answer disaster recovery questions.

Virtual networks connect VMs to other Azure services securely without internet exposure. VMs can communicate with Azure SQL Databases, Storage Accounts, and other services using private endpoints within VNets. The exam tests secure architecture design using these private connections.

VM extensions provide post-deployment configuration through scripts and agents. The Custom Script Extension runs scripts after VM creation, useful for installing applications and configuring settings. The Desired State Configuration extension applies PowerShell DSC configurations. Understanding these automation options helps you answer questions about deployment workflows.

## CLI Commands for the Exam

Make sure you're familiar with these commands for the AZ-204 exam because the exam includes questions with code snippets where you need to identify errors or complete missing parameters.

The az vm create command provisions a new virtual machine and requires numerous parameters including resource group, name, image, size, and authentication credentials. The exam tests whether you can identify missing required parameters or incorrect values.

The az vm list-sizes command queries available VM sizes in a region, often used with query parameters to filter results. Understanding JMESPath query syntax helps you parse and filter command output.

The az vm image list commands find available OS images, and you need to understand how to filter by publisher, offer, and SKU. The exam may ask you to identify the correct command sequence to find a specific image.

The az vm disk attach command adds data disks to VMs, requiring parameters for disk name, size, and SKU. Understanding when to use the new flag versus attaching existing disks helps you answer storage configuration questions.

The az vm deallocate command stops the VM and releases compute resources to stop charges, different from az vm stop which only stops the VM but continues charging. The exam tests whether you understand this crucial distinction.

The az vm delete command removes the VM but by default doesn't delete associated resources like NICs and disks. Understanding what gets deleted automatically versus what remains helps you answer cleanup and cost optimization questions.

## Summary

This Windows VM lab provides hands-on experience with IaaS concepts that appear on the AZ-204 exam. While the exam emphasizes PaaS solutions because they're recommended for most modern cloud applications, understanding VM provisioning, configuration, and management is essential for the Infrastructure as a Service section. Focus on understanding when VMs are the right choice compared to alternatives, how to configure them properly for different scenarios, and how they integrate with other Azure services. The CLI commands and concepts demonstrated in this lab directly translate to exam questions about VM deployment and management, and understanding the cost implications of different configuration choices helps you answer optimization scenarios.
