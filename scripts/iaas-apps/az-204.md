# IaaS Apps - AZ-204 Exam Exercises

Understanding IaaS deployments is crucial for the AZ-204 exam under the implement IaaS solutions domain. These exercises go beyond the basics and focus specifically on the scenarios you'll encounter in the exam. The AZ-204 exam tests not just your ability to create and manage VMs, but your understanding of production scenarios like secure networking, database connectivity, and application deployment strategies.

## Prerequisites

You should complete the basic IaaS apps lab before diving into these exam-focused exercises. The fundamental concepts like VM creation, networking configuration, and database setup are essential building blocks. These advanced exercises assume you're comfortable with the basics and ready to explore the features that distinguish enterprise deployments from simple development scenarios.

## AZ-204 Exam Skills Covered

The exam expects you to demonstrate competency across a wide range of IaaS capabilities. You'll need to understand how to provision virtual machines using different methods including CLI, PowerShell, and ARM templates. Network security configuration is crucial, including Network Security Groups, service endpoints, and private endpoints. Database integration patterns come up frequently, especially connecting applications to Azure SQL Database. Application deployment and configuration management are essential skills, including using VM extensions and custom script extensions. Finally, you must understand monitoring and troubleshooting techniques using Azure Monitor, boot diagnostics, and network watcher.

## Provisioning Virtual Machines

Understanding VM provisioning is fundamental to the AZ-204 exam because many scenarios involve deploying applications to compute resources. The exam will present requirements and expect you to recommend the appropriate approach.

Creating VMs using the Azure CLI is the most common method you'll encounter. The az vm create command has numerous parameters that control every aspect of the VM configuration. You need to know how to specify the image using the publisher, offer, SKU, and version format. Selecting appropriate VM sizes matters because different workloads require different compute characteristics - general purpose D-series for balanced workloads, F-series for compute-intensive applications, E-series for memory-intensive workloads. Authentication configuration varies between Windows and Linux - Windows VMs use username and password while Linux VMs typically use SSH keys, though both support both methods. Network configuration includes attaching NICs, assigning public IPs, and setting DNS names for easier accessibility.

An important exam point is that creating a VM automatically creates several associated resources if they don't already exist. Azure creates a virtual network and subnet if you don't specify existing ones, provisions a network interface to connect the VM to the network, allocates a public IP address if you request one, and creates a network security group with basic rules to allow connectivity. Understanding these automatic resource creations helps you troubleshoot and manage VM deployments effectively.

VM images follow a specific hierarchy that the exam tests frequently. Publishers like MicrosoftWindowsServer, Canonical, or RedHat provide the base images. Each publisher offers multiple image types called offers, like WindowsServer or UbuntuServer. Within each offer are SKUs representing specific versions like 2022-datacenter-core-g2 or 22_04-lts. Finally, each SKU has versions, though you typically use latest to get the most current image. The exam might present a scenario where you need to find the correct image for specific requirements, and you'll need to use az vm image list commands to locate it.

Windows Server Core deserves special mention because it appears in many exam scenarios. It's a minimal installation without the full GUI, which reduces attack surface and resource consumption. Applications run through PowerShell or command line rather than graphical interfaces. The benefits include smaller storage footprint, faster boot times, fewer updates required, and reduced security vulnerabilities. When an exam scenario mentions lightweight Windows deployments or security-hardened servers, Server Core is often the answer.

## Network Security Configuration

Network security is a critical exam topic because protecting resources is a fundamental cloud responsibility. Understanding how to configure Network Security Groups, service endpoints, and firewall rules is essential.

Network Security Groups act as virtual firewalls controlling inbound and outbound traffic. Rules are evaluated by priority with lower numbers processed first. Each rule specifies source and destination which can be IP addresses, CIDR ranges, service tags, or application security groups. Port ranges and protocols define what traffic the rule applies to. Actions are either Allow or Deny, and it's important to remember that explicit deny rules override allow rules. NSGs can be associated with either subnets affecting all resources in that subnet, or individual network interfaces for per-VM control. The exam often presents scenarios where you need to troubleshoot connectivity issues caused by NSG misconfigurations.

Service endpoints provide secure and direct connectivity from virtual networks to Azure services. When you enable a service endpoint on a subnet, traffic to that Azure service travels over the Microsoft backbone network rather than the internet. This improves security because the traffic never leaves Microsoft's network, reduces latency by avoiding internet routing, and allows you to use virtual network rules on Azure services to restrict access to specific subnets. Common service endpoints include Microsoft dot Storage for Storage Accounts, Microsoft dot Sql for SQL Database, and Microsoft dot KeyVault for Key Vault. The exam might describe a scenario where an application can't connect to Azure SQL Database, and the solution involves enabling the SQL service endpoint on the VM's subnet and configuring a virtual network rule on the SQL Server.

Private endpoints take security further by bringing Azure services into your virtual network with a private IP address. Unlike service endpoints which are subnet-level features, private endpoints are actual network interfaces in your subnet. This means the Azure service gets an IP address from your VNet, no public internet exposure is required even for accessing the service, and traffic is completely private within your virtual network. The exam may ask you to distinguish between service endpoints and private endpoints, and the key difference is that private endpoints provide complete network isolation while service endpoints still use public service endpoints but with optimized routing.

## Azure SQL Database Integration

Connecting applications to Azure SQL Database is a common exam scenario that tests your understanding of both networking and security.

The SQL Server and Database hierarchy is important to understand. A logical SQL Server is the management container that doesn't correspond to a physical SQL Server instance. Each logical server can contain multiple databases. Server-level settings include firewall rules, administrator accounts, and Azure Active Directory authentication. Database-level settings include service tier, performance level, backup retention, and geo-replication. When you create resources, you always specify both the server and database names.

Connection strings follow a standard format that you should recognize. The Server parameter includes the fully qualified domain name like yourserver dot database dot windows dot net. The Database parameter specifies which database to connect to. User Id and Password provide SQL authentication credentials, though managed identities are preferred for Azure resources. Additional parameters like Connection Timeout, Encrypt, and TrustServerCertificate control connection behavior. The exam might present a connection string and ask you to identify what needs to be changed for a specific scenario.

Firewall and virtual network rules control network access to SQL Server. IP-based firewall rules allow specific public IP addresses or ranges to connect. Virtual network rules require service endpoints and allow specific VNet subnets to connect. Private endpoints provide private IP connectivity from VNets. The Allow Azure Services setting permits other Azure services to connect, but it's less secure than VNet rules. For the exam, know that the recommended pattern is to use service endpoints and virtual network rules for Azure resources, and private endpoints for the highest security scenarios.

Authentication methods vary in security and convenience. SQL authentication uses username and password stored in the connection string, which is simple but requires credential management. Azure Active Directory authentication integrates with Azure AD for centralized identity management. Managed identities eliminate credentials entirely by using the Azure resource's identity to authenticate, which is the most secure option. The exam strongly favors managed identities for application-to-database connections, and you should recommend them whenever the scenario involves Azure resources connecting to SQL Database.

## Application Deployment and Configuration

Deploying applications to VMs involves more than just copying files. The exam tests your knowledge of automated deployment methods and configuration management.

Manual deployment processes like we demonstrated in the basic lab are fine for learning, but the exam expects you to understand automation approaches. Custom Script Extensions allow you to run PowerShell or Bash scripts during or after VM deployment. Desired State Configuration provides declarative configuration management for Windows VMs. Cloud-init handles Linux VM initialization and configuration. ARM templates and Bicep enable infrastructure as code for complete environment deployment. The exam will present scenarios requiring automated deployments, and you need to know which approach fits each situation.

Custom Script Extensions are particularly important for the exam. They execute scripts from Azure Storage or public URLs with system-level permissions. Extensions can run during initial VM creation or be added to existing VMs. They're idempotent, meaning you can run them multiple times safely. Parameters can be passed to scripts for flexibility. The exam might show you an ARM template or Bicep file with a Custom Script Extension and ask you to identify what it does or fix an error in the configuration.

Configuration management involves more than just application installation. Connection strings and secrets should be stored in Azure Key Vault rather than configuration files. App Configuration provides centralized settings management across multiple applications. Environment variables can supply configuration without file modifications. Managed identities authenticate to other Azure services without credentials in code. The exam scenarios often involve improving security by moving hardcoded credentials to Key Vault or using managed identities instead of connection strings.

## Monitoring and Troubleshooting

The exam includes scenarios where you must diagnose and resolve issues with IaaS deployments. Understanding available diagnostic tools is essential.

Azure Monitor collects metrics and logs from VMs. Metrics include CPU usage, memory, disk I/O, and network traffic. Logs capture application output, system events, and security events. Alerts can notify you of problems or trigger automated responses. VM Insights provides detailed performance analytics including process dependencies. The exam might ask you which metrics to monitor for specific problems or how to configure alerts for certain conditions.

Boot diagnostics capture console output and screenshots during VM startup, which is invaluable for troubleshooting VMs that fail to start correctly. Serial console provides direct access to VM consoles for troubleshooting even when network connectivity is broken. Run Command lets you execute scripts on VMs without RDP or SSH access. These tools are essential when VMs become unresponsive or misconfigured, and the exam may present scenarios where you need to use them for recovery.

Network troubleshooting uses several Azure tools. Network Watcher provides connectivity testing, next hop analysis, and packet capture. NSG flow logs show traffic flowing through Network Security Groups. Connection Monitor tests connectivity between resources over time. IP flow verify checks whether traffic is allowed or denied by NSG rules. The exam often presents connectivity problems between VMs and databases or other services, and you need to know which tool helps diagnose each type of issue.

## Common Exam Scenarios

Let's consolidate the key patterns you'll encounter on the exam. Migration scenarios involve moving on-premises applications to Azure VMs, which requires understanding how to recreate networking, security, and storage configurations in Azure. Secure connectivity scenarios test your knowledge of service endpoints, private endpoints, and NSG rules to protect application-to-database communications. Automated deployment scenarios expect you to use ARM templates, Bicep, or VM extensions rather than manual processes. High availability scenarios involve availability sets, availability zones, and load balancers to ensure applications remain accessible. Monitoring and alerting scenarios require configuring Azure Monitor, Log Analytics, and alerts for production workloads.

The exam loves questions about security best practices. Use managed identities instead of credentials whenever possible because they eliminate credential management and rotation concerns. Store secrets in Key Vault rather than configuration files or environment variables to centralize secret management and audit access. Apply least-privilege access using RBAC to give users and applications only the permissions they need. Use private endpoints for sensitive workloads to eliminate public internet exposure entirely. Enable diagnostic logging for security auditing and compliance requirements.

Cost optimization is another frequent exam topic. Deallocate VMs when not in use because you only pay for storage, not compute. Right-size instances based on actual usage metrics rather than overprovisioning. Use appropriate SQL Database tiers to match performance requirements without overpaying. Consider Reserved Instances for predictable workloads because they offer significant discounts. Delete unused resources promptly because orphaned resources continue incurring charges.

## Practice Recommendations

To prepare for IaaS-related exam questions, you should practice creating VMs using both Portal and CLI to understand all available options. Experiment with different VM sizes and images to learn their capabilities and use cases. Configure network security groups, service endpoints, and firewall rules until you're comfortable with the concepts. Deploy applications manually and using extensions to understand both approaches. Practice Azure SQL Database creation and networking configuration extensively. Work through troubleshooting scenarios using Network Watcher, boot diagnostics, and monitoring tools. Most importantly, understand when to use IaaS versus PaaS solutions because the exam tests architectural decision-making.

Understanding these concepts at a practical level is what separates passing from failing the exam. Microsoft tests application of knowledge, not memorization. Practice the labs, understand why each feature exists and when to use it, and you'll be well-prepared for the IaaS sections of the AZ-204 exam.
