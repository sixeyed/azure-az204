# VM Configuration Automation - AZ-204 Exam Connection

## Exam Objectives

This lab covers key concepts for the AZ-204 exam, specifically around compute solutions and VM management.

## Infrastructure as Code

In the AZ-204 exam, you need to understand how to automate infrastructure deployment and configuration. While VMs aren't the primary focus - you'll see more questions about App Services, Container Instances, and Functions - understanding VM automation demonstrates important principles.

**Custom Script Extensions** are a common pattern across Azure services. You'll see similar extension mechanisms in VM Scale Sets, Azure DevTest Labs, and even in ARM template deployments. The concept of post-deployment configuration is universal.

**Declarative vs Imperative Configuration** - notice how we used both approaches in this lab. The JSON specification for the custom script extension is declarative - you describe what you want. The run-command feature is imperative - you tell Azure exactly what to do, step by step.

## Security and Networking

The NSG configuration we performed is critical for the exam. You need to understand:

**Default Deny** - Azure follows a security-first approach. By default, VMs deny all inbound traffic from the Internet. You explicitly allow only what's needed.

**Priority Rules** - NSG rules have priority numbers from 100 to 4096. Lower numbers are evaluated first. Default rules start at 65000, so custom rules typically use lower numbers to take precedence.

**Source and Destination** - rules can filter by IP address ranges, service tags, or application security groups. In our lab, we used "Internet" as a source, which means all public IP addresses.

## Automation Patterns

For the exam, understand these automation patterns:

**VM Extensions** run after the VM is created. They're asynchronous operations - the VM is running while the extension executes. This is important for scripting: you can't assume the extension has completed just because the VM is running.

**Cloud-init** runs during VM provisioning on Linux. It's synchronous with the boot process. The VM isn't fully available until cloud-init completes.

**Run Commands** are on-demand operations. Unlike extensions, they don't persist - they execute once and you get the output immediately.

## Integration Scenarios

Think about how VMs fit into larger solutions:

**Web Applications** - while you might deploy web apps to Azure App Service, you could also use VMs with custom script extensions to install web servers. You need to understand the tradeoffs: VMs give you more control but require more management.

**Development Environments** - our Windows VM example with dev tools installation is a common pattern for creating consistent development environments. In production scenarios, you might use Azure DevTest Labs or Virtual Desktop instead.

**Hybrid Solutions** - VMs are often used in hybrid scenarios where you need compatibility with on-premises infrastructure. The networking concepts we covered - NSGs, private IPs, VNets - are essential for hybrid connectivity.

## Common Exam Questions

You might see questions like:

"You need to ensure a script runs after a Linux VM is created. The script must complete before the VM is considered ready. Which approach should you use?"
- Answer: Cloud-init (runs during provisioning)

"You need to install monitoring agents on 100 VMs. Which approach is most efficient?"
- Answer: VM extensions (can be deployed at scale via ARM templates or VM Scale Sets)

"You need to debug a connectivity issue on a running VM without logging in. What should you do?"
- Answer: Use run-command to execute diagnostic scripts

## Key Takeaways

For the AZ-204 exam, remember:

1. **Automation is essential** - manual configuration doesn't scale
2. **Extensions vs run-commands** - understand when to use each
3. **Security defaults to deny** - you must explicitly allow access
4. **NSG rules use priority** - lower numbers take precedence
5. **Multiple automation options exist** - choose based on requirements

While VMs aren't the primary compute option in modern cloud applications, understanding their automation and configuration demonstrates principles that apply across all Azure compute services.

Good luck with your exam preparation!
