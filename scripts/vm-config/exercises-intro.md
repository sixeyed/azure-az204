We've covered automating VM configuration to eliminate manual, time-consuming, error-prone setup tasks that don't scale. Azure provides options to configure VMs during deployment or after creation. Now let's automate VM setup hands-on.

When you explore VM configuration in the Portal, head to the Advanced tab during VM creation. You'll see three configuration mechanisms: Extensions are add-ons running after VM creation that can install software or configure settings. Applications are packaged software components attachable to VMs. Cloud-init is an industry-standard Linux tool for configuring VMs on first boot. All serve the same purpose, automating configuration for scaling and consistency, but they work at different stages and with different approaches.

Using Linux with custom script extension starts with creating a Linux VM, then adding the extension using az vm extension set with JSON specifying commandToExecute. The JSON contains commands like apt-get update and apt-get install nginx. The extension runs on the VM immediately, automatically installing and configuring the web server. It's a post-deployment approach, meaning your VM is already running when the extension executes.

Testing the web server reveals an interesting problem. When you try to browse to the VM, you can't access it because incoming traffic to port 80 is blocked. You examine NSG rules with az network nsg rule list and discover the default DenyAllInBound rule at priority 65500 blocking all incoming traffic from the Internet. You create a new rule with az network nsg rule create at priority 100, and lower numbers take precedence, allowing HTTP traffic on port 80 from the Internet. Now your Nginx server is accessible.

Using Windows with VM extension demonstrates how the same automation concepts apply to Windows VMs. You can use the Windows custom script extension, but there's an easier option: az vm run-command invoke. This feature executes PowerShell scripts on-demand without installing extensions. You create a Windows 11 VM and run a setup script that installs development tools using Chocolatey package manager, demonstrating an easier alternative for on-demand script execution.

The lab challenge involves testing network connectivity between VMs using run commands to print IP addresses and test connectivity, discovering whether VMs in the same resource group are automatically networked together or if Azure networking works differently.

Custom script extensions automate post-deployment configuration, cloud-init handles Linux provisioning, run commands execute on-demand scripts, and NSG rules with priority control network access following default-deny security principles. Let's master VM configuration automation!
