# Securing Key Vault Access - AZ-204 Exam Relevance

## AZ-204 Exam Connection

This lab directly addresses several key objectives in the AZ-204 Microsoft Azure Developer Associate certification exam. Let's break down how securing Key Vault access relates to the exam requirements.

## Implement Azure Security

The AZ-204 exam includes a domain specifically focused on implementing Azure security solutions. Key Vault access control is a critical component of this domain.

### Key Vault Access Policies

You need to understand how to configure access policies to control what principals can do with secrets, keys, and certificates. The exam may present scenarios where you need to:

- Grant read-only access to secrets for an application
- Provide key management permissions to specific users
- Understand the principle of least privilege when configuring access

### Network Security

The exam tests your knowledge of securing Azure resources at the network level. For Key Vault, this includes:

- Configuring virtual network service endpoints
- Understanding when and why to restrict Key Vault to specific networks
- Implementing defense in depth by combining network restrictions with access policies

## Managed Identities

Managed identities are a major topic on the AZ-204 exam. You'll likely see multiple questions about:

### System-Assigned vs User-Assigned Identities

This lab uses a system-assigned managed identity, which is tied to the lifecycle of a single Azure resource. Be aware that user-assigned identities also exist and can be shared across multiple resources.

### Authentication Flow

Understand how managed identities work behind the scenes:
- Azure resources with managed identities can request tokens from the Azure Instance Metadata Service
- These tokens authenticate the resource with other Azure services
- No credentials need to be stored in code or configuration files

### Common Use Cases

The exam often presents scenarios where you need to choose the right authentication method. Managed identities are the preferred solution when:
- An Azure service needs to access another Azure service
- You want to eliminate credentials from your application code
- You need automatic credential rotation without application changes

## Service Endpoints vs Private Endpoints

This lab demonstrates service endpoints. Be aware that the exam may also test you on Private Endpoints and Private Link, which provide even more isolated connectivity. Know the differences:

**Service Endpoints:**
- Free to use
- Traffic stays on the Azure backbone network
- Source IP addresses from the virtual network are visible to the service
- Configured at the subnet level

**Private Endpoints:**
- Have associated costs
- Create a private IP address for the service inside your virtual network
- Service appears as a resource within your network
- Provides more granular security

## Access Policy vs RBAC

While this lab focuses on access policies, you should know that Key Vault also supports Azure Role-Based Access Control (RBAC). The exam may test when to use each approach:

**Access Policies:**
- Traditional Key Vault permission model
- Configured directly on the Key Vault
- Supports all Key Vault features

**RBAC:**
- Newer option using Azure's standard RBAC system
- Consistent with other Azure services
- Centralized permission management

## Exam Tips

When facing Key Vault security questions on the AZ-204 exam:

1. **Always prefer managed identities** over service principals when authenticating Azure services with each other.

2. **Remember the two layers** - network access is separate from identity-based access. Both can deny access independently.

3. **Understand soft delete** - Key Vault's soft delete and purge protection features are important for data protection and compliance.

4. **Know the commands** - You should be comfortable with `az keyvault` commands for creating vaults, managing secrets, setting access policies, and configuring network rules.

5. **Consider the scenario** - Exam questions often describe a security requirement. Think about whether it's a network-level concern, an identity-based concern, or both.

## Key Commands to Remember

Make sure you're comfortable with these Azure CLI commands for the exam:

```
# Create a Key Vault
az keyvault create -n <name> -g <rg> -l <location>

# Set a secret
az keyvault secret set --name <name> --value <value> --vault-name <vault>

# Grant access policy
az keyvault set-policy --secret-permissions get list --object-id <id> -n <vault>

# Configure managed identity
az vm identity assign -n <vm-name> -g <rg>

# Add network rule
az keyvault network-rule add --vnet-name <vnet> --subnet <subnet> -n <vault>

# Update default action
az keyvault update --default-action Deny -n <vault> -g <rg>
```

## Related Exam Topics

This lab connects to several other AZ-204 topics you should review:

- **Azure Active Directory authentication** - Understanding how principals authenticate with Azure services
- **Virtual Networks** - Subnets, service endpoints, and network security groups
- **Azure Resource Manager** - Role assignments and access control
- **Application Configuration** - Using Key Vault to externalize configuration and secrets
- **Secure Solutions** - Implementing solutions that follow security best practices

## Practice Scenarios

For exam preparation, practice scenarios like:

- An application running in Azure App Service needs to read database connection strings from Key Vault
- Multiple VMs need to access the same Key Vault using shared credentials
- A development team needs to list secrets but not read their values
- An application needs to access Key Vault but must use private connectivity only

Understanding the concepts from this lab will help you choose the correct solution for these types of scenarios.
