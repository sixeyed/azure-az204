# Distributed Apps on Azure Container Instances - AZ-204 Exam Perspective

## Exam Relevance

This lab covers skills measured in the AZ-204 exam under the "Implement Azure Container Instances" section. Understanding how to deploy and manage multi-container groups is essential for the exam.

## Key Exam Topics Covered

### 1. Container Groups

**Exam Focus**: Understanding container groups and how containers within a group share resources.

In ACI, a container group is a collection of containers that get scheduled on the same host machine. Containers in a group share:
- A lifecycle (started and stopped together)
- A local network (can communicate via localhost)
- Storage volumes (can mount the same volumes)
- An IP address and port namespace

**Exam Tip**: Know that containers in a group share the same network namespace, which is why services can communicate using `localhost`. This is different from running separate container instances.

### 2. ACI YAML Specification

**Exam Focus**: Understanding the Azure-specific YAML format for defining container groups.

Key elements you need to know:
- **Resource Limits**: CPU and memory specifications are mandatory in ACI YAML (unlike Docker Compose where they're optional)
- **Port Configuration**: Ports must be exposed at both the container level and the IP address level
- **Environment Variables**: Used for configuration and inter-container communication
- **Image Registry**: Can pull from public registries or Azure Container Registry with authentication

**Exam Tip**: The ACI YAML format is Azure-specific. Don't confuse it with Kubernetes YAML or Docker Compose syntax. Questions may test your knowledge of required vs. optional fields.

### 3. Docker Compose Integration

**Exam Focus**: Understanding how Docker Compose files can be deployed to ACI using Docker CLI.

The Docker ACI integration:
- Allows standard Compose files to be deployed to ACI
- Automatically handles some ACI-specific requirements
- Creates additional sidecar containers for networking
- Requires Azure authentication and context configuration

**Exam Tip**: Know the command sequence: `docker login azure`, `docker context create aci`, `docker context use`, and then standard `docker compose` commands. The exam may ask about the order of operations or troubleshooting authentication issues.

### 4. Container Updates and Lifecycle

**Exam Focus**: Understanding how configuration changes affect running containers.

Critical concept: You cannot update the configuration of a running container. Any change to:
- Environment variables
- Resource limits (CPU/memory)
- Port mappings
- Volume mounts

...requires recreating the container. ACI handles this by:
1. Creating new containers with the updated configuration
2. Killing the old containers
3. Routing traffic to the new containers

**Exam Tip**: Questions may present scenarios asking what happens when you redeploy with changed configuration. The answer is that containers are replaced, not updated in place. This causes temporary downtime.

### 5. Storage Integration

**Exam Focus**: Understanding how ACI integrates with Azure Storage services.

Two integration methods:

**Azure Blob Storage**:
- Accessed via connection strings in environment variables
- Application code uses Azure SDK or REST API
- No special ACI configuration required
- Data persists independently of container lifecycle

**Azure Files**:
- Mounted as volumes in the container filesystem
- Requires Storage Account name and key in ACI specification
- Appears as a directory inside the container
- Multiple containers can mount the same share

**Exam Tip**: Know the difference between these approaches. Blob Storage requires application code changes and SDK usage. Azure Files mounting is transparent to the application - it just reads/writes to what looks like a local directory.

### 6. Storage Account Authentication

**Exam Focus**: Understanding connection strings, keys, and secure credential management.

Key concepts:
- **Connection Strings**: Complete access credentials including account name, key, and endpoints
- **Account Keys**: Storage Account has two keys that can be rotated
- **Key Rotation**: Can regenerate keys without downtime by using the alternate key
- **Secure Storage**: Should use Key Vault for production, not environment variables

**Exam Tip**: Questions may ask about secure ways to provide credentials to containers. Know that:
- Environment variables in YAML files are not secure
- Azure Key Vault is the recommended approach for production
- Managed identities can be used with ACI for credential-free access

### 7. Networking and Connectivity

**Exam Focus**: Understanding networking in container groups.

Important points:
- Containers in a group share a single public IP address
- Each container can expose multiple ports
- External access requires port mapping at the group level
- Internal communication uses `localhost` and container ports
- DNS names are optional but useful for stable endpoints

**Exam Tip**: Scenario questions may ask how Container A can call Container B in the same group (answer: localhost). Or how external users access services (answer: public IP with port mapping).

### 8. Docker Context Management

**Exam Focus**: Understanding how Docker CLI can target different environments.

The context system allows switching between:
- Local Docker Desktop (`default` context)
- ACI in Azure (`aci` context type)
- Other cloud providers or remote Docker engines

Commands to know:
```bash
docker context create aci <name> --resource-group <rg>
docker context use <name>
docker context ls
docker context rm <name>
```

**Exam Tip**: Questions may ask about troubleshooting "why can't I see my Azure containers?" The answer often relates to which context is active. Also know that some Docker commands don't work in ACI context (like `docker build`).

## Common Exam Scenarios

### Scenario 1: Multi-Container Communication
"You have a web application and API that need to communicate. How should you deploy them to ACI?"

**Answer**: Deploy them in the same container group. Configure the web app to call the API using `localhost:<port>`. Share the same network namespace.

### Scenario 2: Persistent Data
"Your containerized application needs to persist data beyond container restarts. What should you do?"

**Answer**: Mount an Azure Files share or use Azure Blob Storage with connection strings. For Files, specify the volume mount in ACI YAML. For Blob, pass connection string as environment variable.

### Scenario 3: Configuration Updates
"You need to change an environment variable in a running container. What's the best approach?"

**Answer**: Update the YAML/Compose file and redeploy using `az container create` or `docker compose up`. The containers will be recreated with new configuration. Note this causes brief downtime.

### Scenario 4: Secure Credentials
"How should you securely provide Storage Account keys to containers?"

**Answer**: In production, use Azure Key Vault and reference secrets in your deployment. For managed identities, configure ACI to use system-assigned or user-assigned identities. Avoid hardcoding credentials in YAML files.

## Important Exam Commands

Make sure you know these commands and their parameters:

```bash
# Deploy from YAML
az container create -g <resource-group> -n <name> --file <yaml-file>

# Get container logs
az container logs -g <resource-group> -n <name> --container-name <container>

# Show container details
az container show -g <resource-group> -n <name>

# Attach to running container
az container attach -g <resource-group> -n <name>

# Execute command in container
az container exec -g <resource-group> -n <name> --exec-command <command>

# Create Azure Files share
az storage share create -n <share-name> --account-name <sa-name>

# Get storage account keys
az storage account keys list -g <resource-group> --account-name <sa-name>

# Get connection string
az storage account show-connection-string -g <resource-group> -n <sa-name>
```

## Study Recommendations

1. **Practice**: Deploy multi-container applications using both YAML and Compose approaches
2. **Understand Differences**: Know when to use ACI YAML vs. Docker Compose
3. **Storage Scenarios**: Practice mounting Azure Files and using Blob Storage
4. **Troubleshooting**: Know how to view logs, attach to containers, and execute commands
5. **Security**: Understand best practices for managing credentials and secrets
6. **Limitations**: Know what ACI can't do (no horizontal scaling, no persistent local storage)

## Key Takeaways for the Exam

- Container groups share network, lifecycle, and can share storage
- Configuration changes require container recreation
- ACI YAML format is Azure-specific with required resource specifications
- Docker Compose can deploy to ACI with proper context configuration
- Azure Files mounts as volumes; Blob Storage accessed via SDK
- Use Key Vault for secure credential management in production
- Know CLI commands for deployment, monitoring, and troubleshooting
- Understand networking: public IP for group, localhost for inter-container communication
