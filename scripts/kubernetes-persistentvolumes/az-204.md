# Kubernetes Persistent Volumes - AZ-204 Exam Focus

## Video Narration Script - Exam Preparation and Azure Integration

---

### Opening (15 seconds)

Welcome to the AZ-204 focused segment on Kubernetes Persistent Volumes. In this video, we're going to connect what you've learned about Kubernetes storage concepts to the specific Azure services and exam scenarios you'll encounter on the AZ-204 certification exam. Let's dive into what Microsoft expects you to know.

---

### Part 1: AZ-204 Storage Domains (1 minute)

**[Screen: Show exam objectives slide]**

The AZ-204 exam tests your knowledge across multiple storage-related domains. When it comes to Kubernetes and Azure Kubernetes Service, the exam focuses heavily on how you implement container solutions, including stateful applications.

You need to understand several key areas. First, how Azure Kubernetes Service integrates with Azure's storage services. Second, how to configure and use persistent storage in containerized applications. And third, how to choose the right storage solution based on application requirements and performance characteristics.

The exam loves scenario-based questions. You'll see questions like "An application requires shared storage accessible from multiple pods" or "You need to provide high-performance storage for a database running in AKS." You need to know which Azure storage service and which Kubernetes storage configuration to use for each scenario.

---

### Part 2: Azure Disk vs Azure Files Integration (2.5 minutes)

**[Screen: Show comparison table]**

Let's talk about the two primary Azure storage options for AKS: Azure Disks and Azure Files. Understanding when to use each is absolutely critical for the exam.

Azure Disks are block storage devices. Think of them like virtual hard drives that get attached to a single node. They support ReadWriteOnce access mode, which means only one pod on one node can mount the disk at a time. Azure Disks are perfect for databases, stateful applications, or any workload that needs dedicated, high-performance storage.

In Azure Kubernetes Service, when you create a Persistent Volume Claim with ReadWriteOnce access, the default behavior is to provision an Azure Managed Disk. You'll see storage classes like "managed-premium" for SSD-backed storage or "managed-standard" for HDD-backed storage.

**[Screen: Show Azure Files architecture]**

Azure Files, on the other hand, provides fully managed file shares using the SMB protocol. The key difference is that Azure Files supports ReadWriteMany access mode. Multiple pods across multiple nodes can mount the same file share simultaneously.

This makes Azure Files ideal for scenarios where you need shared storage. Think about applications like WordPress where multiple web server pods need to access the same uploaded media files. Or legacy applications that expect a traditional file share. Or scenarios where you need to share configuration files across multiple pods.

**[Screen: Show decision tree graphic]**

Here's a simple decision tree for the exam. Ask yourself: does my application need shared access from multiple pods? If yes, Azure Files with ReadWriteMany. If no, and you need high performance, Azure Disk with ReadWriteOnce.

The exam will test your understanding of these access patterns. You might see a question describing an application's requirements, and you need to choose between Azure Disk and Azure Files based on the access pattern, performance needs, and cost considerations.

One more critical point: Azure Disks are zone-specific. If your pod moves to a different availability zone, the disk can't move with it. Azure Files, being network-based, don't have this limitation. The exam may present scenarios testing your understanding of availability zones and storage accessibility.

---

### Part 3: Storage Classes and Dynamic Provisioning in AKS (2 minutes)

**[Screen: Show AKS storage class examples]**

In Azure Kubernetes Service, storage classes define the type of Azure storage to provision. Let's look at the default storage classes you'll encounter.

"default" typically maps to Azure Disk with standard HDD storage. It's slower but cost-effective.

"managed-premium" provisions Azure Premium SSD disks. This is what you'd use for databases or I/O intensive workloads. On the exam, when you see terms like "high IOPS requirements" or "database workload," think managed-premium.

"azurefile" provisions Azure Files with standard performance. "azurefile-premium" gives you premium performance for file shares.

**[Screen: Show PVC YAML example]**

Here's what's important for the exam: you can specify a storage class in your Persistent Volume Claim using the "storageClassName" field. If you omit it, you get the default storage class. If you want specific performance characteristics, you explicitly name the storage class.

Dynamic provisioning is the default behavior in AKS. When you create a PVC, Azure automatically provisions the underlying storage resource. You don't need to pre-create Azure Disks or File Shares manually. This is huge for exam scenarios because it means you can deploy applications without pre-provisioning infrastructure.

The exam may present scenarios where you need to understand the cost implications. Premium storage costs more but provides better performance. Standard storage is cheaper but slower. You need to match storage class selection to both application requirements and budget constraints.

**[Screen: Show retention policy options]**

Another exam topic: what happens to the Azure storage when you delete a PVC? By default, with dynamic provisioning, when you delete the PVC, the underlying Azure Disk or File Share is also deleted. This is the "Delete" reclaim policy.

There's also a "Retain" policy where the storage persists even after PVC deletion. The exam might test your understanding of these policies, especially in scenarios involving data backup, disaster recovery, or compliance requirements.

---

### Part 4: Stateful Applications and StatefulSets (2 minutes)

**[Screen: Show StatefulSet architecture diagram]**

Let's talk about stateful applications. The AZ-204 exam expects you to understand how Kubernetes handles applications that maintain state, like databases, message queues, or data processing systems.

While we've been using Deployments in our demos, real stateful applications typically use StatefulSets. StatefulSets provide guarantees about ordering and uniqueness of pods. Each pod gets a stable network identity and its own dedicated Persistent Volume Claim.

**[Screen: Show StatefulSet with PVC template]**

Here's what makes StatefulSets special for storage. Instead of manually creating PVCs, StatefulSets use volume claim templates. When you scale the StatefulSet, Kubernetes automatically creates new PVCs for each new pod. Each pod gets its own persistent storage that moves with it.

The exam loves scenarios involving databases. "You need to deploy a MongoDB replica set in AKS" or "Deploy a Kafka cluster with persistent storage." The answer almost always involves StatefulSets with volume claim templates backed by Azure Disks.

**[Screen: Show scaling scenario]**

Think about scaling. With a Deployment using a shared PVC, all pods share the same storage. With a StatefulSet, each pod has its own PVC and its own Azure Disk. This isolation is critical for databases where each replica needs its own data directory.

For the exam, remember: stateful applications use StatefulSets, each pod gets its own PVC, and those PVCs persist even when pods are rescheduled to different nodes.

---

### Part 5: Common Exam Scenarios and Patterns (2.5 minutes)

**[Screen: Show scenario examples]**

Let's walk through some typical exam scenarios and the correct approach.

**Scenario One**: "An application running in AKS requires persistent storage for a PostgreSQL database. The storage must survive pod restarts and provide high performance."

The answer: Use a StatefulSet with a volume claim template requesting managed-premium storage class. The PVC should specify ReadWriteOnce access mode since databases don't need shared access. This provisions an Azure Premium SSD managed disk.

**Scenario Two**: "Multiple web application pods need concurrent read-write access to shared uploaded files."

The answer: Create a PVC with ReadWriteMany access mode using the azurefile storage class. This provisions an Azure File Share that all pods can mount simultaneously.

**Scenario Three**: "You need to ensure database data persists even if the PVC is accidentally deleted."

The answer: Create a custom storage class with the reclaim policy set to Retain instead of Delete. Or manually create Persistent Volumes with the Retain policy and bind them to your PVCs.

**Scenario Four**: "An application requires 500 gigabytes of storage with at least 1000 IOPS."

The answer: Use managed-premium storage class. The storage request in the PVC determines the disk size, and premium disks provide IOPS based on size. A 500 GB premium SSD provides well over 1000 IOPS.

**[Screen: Show troubleshooting checklist]**

The exam also tests troubleshooting skills. Common issues you should know:

PVC stuck in Pending status: Check if the requested storage class exists. Verify you have quota available in your Azure subscription. Check if the access mode is supported by the storage class.

Pod fails to start with volume mounting errors: The node might not be in the same availability zone as the Azure Disk. Verify the disk isn't already mounted by another pod if using ReadWriteOnce.

Performance issues: Standard storage might not meet IOPS requirements. Consider upgrading to premium storage class.

**[Screen: Show monitoring and management]**

For the exam, you should also understand how to monitor and manage persistent volumes. Know how to use kubectl commands to check PVC status, see which pod is using which volume, and identify storage capacity issues.

The Azure portal integration is important too. You should know that Azure Disks and File Shares created by AKS appear in your resource group. You can view them, check performance metrics, and manage backups through Azure Backup services.

---

### Part 6: Security Considerations (1.5 minutes)

**[Screen: Show security best practices]**

Security is always a major topic on Azure exams, and storage is no exception.

First, understand Azure role-based access control for storage. Your AKS cluster needs appropriate permissions to create and attach Azure Disks and File Shares. This is typically handled by the AKS service principal or managed identity.

For sensitive data, the exam expects you to know about encryption. Azure Disks are encrypted at rest by default using platform-managed keys. You can also use customer-managed keys stored in Azure Key Vault for additional control.

Azure Files supports encryption in transit when using SMB 3.0. Make sure you understand when data is encrypted and when it might be transmitted unencrypted.

**[Screen: Show network security diagram]**

Network security is another consideration. Azure Files can be restricted to specific virtual networks using service endpoints or private endpoints. This prevents public internet access to your storage. The exam might present scenarios where you need to secure storage access within your virtual network.

Finally, understand Kubernetes RBAC for storage. Not every pod should be able to create or delete PVCs. Use role bindings to control which service accounts can manage storage resources.

---

### Part 7: Backup and Disaster Recovery (1.5 minutes)

**[Screen: Show backup strategies]**

Data protection is crucial for stateful applications, and the exam will test your knowledge of backup and recovery strategies.

Azure Backup integrates with AKS to back up both your cluster configuration and persistent volumes. You should understand that backing up persistent volumes means backing up the underlying Azure Disks or File Shares.

**[Screen: Show snapshot concepts]**

Azure Disk snapshots provide point-in-time copies of your data. You can create snapshots manually or automate them using Azure Backup. Snapshots are incremental, so they're storage-efficient and fast to create.

For the exam, know how to restore data. You can create a new Azure Disk from a snapshot, then create a PV that references that disk, and finally create a PVC that binds to that PV. Or you can use Azure Backup's integrated restore capabilities.

**[Screen: Show disaster recovery diagram]**

Disaster recovery scenarios might involve replicating storage across regions. Azure Files supports geo-redundant storage, but Azure Disks do not. For cross-region DR with Azure Disks, you'd need to implement snapshot replication or use Azure Site Recovery.

The exam loves questions about recovery time objectives and recovery point objectives. Understand that snapshots provide fast recovery but might lose recent data. Continuous replication provides minimal data loss but is more complex to implement.

---

### Part 8: Cost Optimization (1 minute)

**[Screen: Show cost comparison]**

Finally, let's talk about cost optimization, which is increasingly important on Azure exams.

Storage costs money, and unused persistent volumes can accumulate significant charges. The exam expects you to understand how to minimize costs.

First, right-size your storage requests. Don't request one terabyte if you only need 100 gigabytes. Storage is provisioned based on your PVC request, and you pay for what you provision, not what you use.

Second, choose the appropriate performance tier. Premium storage costs more than standard. Use premium only when you need the performance. Many applications run fine on standard storage.

Third, implement lifecycle policies. Delete PVCs when applications are decommissioned. Use the Delete reclaim policy so underlying storage is automatically cleaned up.

**[Screen: Show monitoring costs]**

Azure Cost Management can show you storage costs broken down by resource. The exam might present a scenario where storage costs are unexpectedly high, and you need to identify orphaned disks or file shares that are no longer needed.

---

### Closing and Exam Tips (1 minute)

**[Screen: Show key takeaways slide]**

Let's wrap up with key takeaways for the AZ-204 exam.

One: Understand the differences between Azure Disk and Azure Files, and when to use each. ReadWriteOnce versus ReadWriteMany is the key decision point.

Two: Know the default storage classes in AKS and how to select the appropriate class based on performance and cost requirements.

Three: Understand StatefulSets for stateful applications and how volume claim templates work.

Four: Be comfortable with common troubleshooting scenarios related to persistent volumes.

Five: Know the security considerations, including encryption, network isolation, and access control.

Six: Understand backup and disaster recovery options for persistent data.

**[Screen: Show study resources]**

Practice is essential. Set up your own AKS cluster, create PVCs with different storage classes, deploy stateful applications, and experiment with different scenarios. The hands-on experience will make these concepts stick.

Remember, the exam focuses on real-world scenarios. Don't just memorize commands. Understand the underlying concepts and how to apply them to solve business problems.

**[Screen: Closing slide]**

Good luck with your AZ-204 preparation! With a solid understanding of persistent volumes and Azure storage integration, you'll be well-prepared for the storage-related questions on the exam. Thanks for watching!
