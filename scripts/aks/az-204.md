# Azure Kubernetes Service - AZ-204 Exam Exercises

Azure Kubernetes Service appears in the AZ-204 exam under the containerized solutions domain, typically accounting for ten to fifteen percent of your exam score. The exam tests not just your ability to create and manage clusters, but your understanding of how to deploy and scale containerized applications, integrate with other Azure services, and troubleshoot common issues. Understanding AKS is crucial because it represents the enterprise approach to container orchestration on Azure.

## Creating and Managing AKS Clusters

The exam expects you to understand both the Portal and CLI approaches to creating AKS clusters. While the Portal provides a visual interface with wizards and presets, the CLI offers the automation and repeatability that production environments require. You'll need to know the essential parameters for cluster creation including resource group assignment, cluster name and location, node count and VM sizes, and Kubernetes version selection.

When you create an AKS cluster, Azure provisions a managed resource group with a name that begins with MC underscore. This managed resource group contains all the underlying infrastructure - the virtual machines that serve as nodes, network interfaces, load balancers, network security groups, and public IP addresses. This separation is important to understand for the exam because you should never directly modify resources in the managed resource group. All interactions should go through the AKS resource itself using either the Azure CLI or kubectl commands.

The VM size you choose for your nodes determines the compute resources available to your workloads. Larger VM sizes provide more CPU and memory but cost more. The exam might present scenarios where you need to recommend the appropriate VM size based on application requirements. Understanding node pools is also important - you can have multiple node pools in a single cluster with different VM sizes, allowing you to run different types of workloads efficiently. You might have a pool of standard VMs for web applications and another pool with GPU-enabled VMs for machine learning workloads.

## Connecting to AKS Clusters

Understanding authentication is crucial for the exam. The az aks get-credentials command downloads cluster credentials and configures kubectl to connect to your AKS cluster. Behind the scenes, this command retrieves the cluster connection information from Azure, modifies your kubeconfig file with the new cluster details, and sets this cluster as your current context. The kubeconfig file is what kubectl reads to determine which cluster to communicate with and how to authenticate.

The exam might test your understanding of kubectl contexts. When you work with multiple clusters - perhaps a development cluster, staging cluster, and production cluster - you use contexts to switch between them. The kubectl config get-contexts command shows all available clusters, and the asterisk indicates your current context. Being able to identify which cluster you're connected to is critical for avoiding mistakes in production environments.

In production scenarios, you'll often use Azure Active Directory integration for authentication. This allows you to control access to cluster resources using the same identity and access management you use for other Azure resources. While the exam may not dive deep into AAD integration configuration, you should understand that it exists and why it's preferable to using basic admin credentials for production workloads.

## Deploying Applications to AKS

The exam expects solid understanding of Kubernetes deployment concepts. Deployments define how your application runs, including which container image to use, how many replicas to create, environment variables to inject, and resource requests and limits. Services expose your application to network traffic, with different types serving different purposes. A ClusterIP service provides internal access within the cluster, a NodePort service exposes your application on each node's IP at a static port, and a LoadBalancer service provisions an Azure Load Balancer with a public IP address for external access.

ConfigMaps and Secrets are critical for the exam because they represent best practices for configuration management. ConfigMaps store non-sensitive configuration data that pods can consume as environment variables or mounted files. Secrets store sensitive data like database connection strings, API keys, and certificates. The exam values security-minded solutions, so always use Secrets for sensitive data and never hardcode credentials in your application code or YAML files.

The declarative approach to deployments is fundamental to Kubernetes and appears frequently in exam scenarios. You describe the desired state in YAML manifests and use kubectl apply to create or update resources. Kubernetes compares the desired state with the current state and makes whatever changes are necessary to achieve the desired state. This idempotent approach means you can apply the same manifest multiple times safely.

## Scaling Applications

Understanding both pod scaling and cluster scaling is important for the exam. Horizontal pod scaling changes the number of pod replicas running your application. You can scale manually by modifying the replicas field in your deployment and reapplying the manifest, or you can use the kubectl scale command for quick adjustments. When you scale a deployment to multiple replicas, Kubernetes automatically distributes those pods across available nodes and the service load balances traffic across all healthy pods.

Vertical scaling changes the resources allocated to individual pods by modifying the CPU and memory requests and limits. This requires recreating the pods with the new resource specifications. The exam might present scenarios where you need to recommend horizontal versus vertical scaling based on application characteristics. Stateless web applications typically benefit from horizontal scaling, while database applications might require vertical scaling to handle larger datasets.

Cluster scaling changes the number of nodes in your cluster. The az aks scale command adds or removes nodes, changing the overall capacity available for running pods. More nodes provide more capacity but increase costs. The exam expects you to understand that you can't run unlimited pods on a fixed number of nodes - each node has finite resources, and Kubernetes won't schedule pods if there isn't sufficient capacity available.

Autoscaling is an advanced topic that might appear in exam scenarios. The Horizontal Pod Autoscaler automatically adjusts the number of pod replicas based on CPU utilization or custom metrics. The Cluster Autoscaler automatically adds or removes nodes based on pod scheduling demands. Understanding when to use autoscaling versus manual scaling is important for cost optimization and performance.

## Integration with Azure Container Registry

The exam loves to test ACR integration because it's such a common scenario. When you create an AKS cluster with the attach-acr parameter, Azure automatically configures the necessary permissions so your cluster can pull images from your private container registry. Behind the scenes, this grants the AKS kubelet managed identity the AcrPull role on your registry, eliminating the need for image pull secrets.

In scenarios where you don't use integrated authentication, Kubernetes uses image pull secrets to authenticate with private registries. You create a secret containing your registry credentials and reference it in your pod specifications. However, the attach-acr approach is simpler and more secure because there are no credentials to manage or rotate. The exam typically expects you to recommend the managed identity approach for Azure services.

If you create an AKS cluster without ACR integration and later need to add it, you can use the az aks update command with the attach-acr parameter. This is common in scenarios where the ACR is created after the cluster or where multiple clusters need access to the same registry.

## Monitoring and Troubleshooting

The exam expects you to know basic troubleshooting approaches. When something goes wrong with your application, you start with kubectl get pods to see pod status. Pods might be in Pending, Running, Failed, or CrashLoopBackOff states. The state gives you your first clue about what's wrong. For detailed information, kubectl describe pod shows events that explain why a pod isn't starting or is experiencing issues.

Common issues you'll see in the exam include ImagePullBackOff errors, which indicate problems pulling the container image from the registry. This typically means ACR integration isn't configured or the image name is wrong. Pods stuck in Pending state usually indicate insufficient cluster resources - there aren't enough available nodes to schedule the pod. CrashLoopBackOff means the application is starting but then crashing repeatedly, which typically indicates an application-level problem like a missing environment variable or failed database connection.

The kubectl logs command lets you view the console output from your application running in a pod. This is invaluable for debugging application issues. For pods with multiple containers, you specify which container's logs you want to view. Understanding how to access logs is critical for the exam because many troubleshooting scenarios require analyzing application output.

Azure Monitor Container Insights provides comprehensive monitoring for AKS clusters. You don't need to know deep configuration details for the exam, but understand that it collects metrics and logs from your cluster, provides visibility into performance and health, and can alert you to issues. The exam might present scenarios where you need to recommend enabling Container Insights for production workloads.

## Service Types and Networking

Understanding the three main service types is crucial for the exam. ClusterIP is the default and provides internal access within the cluster. This is what you use for internal services that don't need external access, like databases or backend APIs that are only called by other pods in the cluster. The service gets a cluster-internal IP address that's stable even if pods are recreated.

NodePort extends ClusterIP by exposing the service on a static port on each node's IP address. This allows external access, but you need to know the node IPs and the NodePort. This is typically used for development or testing scenarios, not production. The port range is limited to 30000 through 32767, and you need to manage firewall rules to allow access.

LoadBalancer is what you use for production external access. It provisions an Azure Load Balancer with a public IP address and routes traffic to your service. The load balancer distributes incoming requests across all healthy pods. This is the recommended approach for exposing web applications to the internet. The exam expects you to understand that Azure provisions real infrastructure when you create a LoadBalancer service, and you're charged for the load balancer and public IP.

Understanding how traffic flows is important. External traffic hits the load balancer's public IP, the load balancer forwards to a node in the cluster, the node's kube-proxy routes to the appropriate pod based on service rules. If the pod isn't on that node, traffic is forwarded to the correct node. The service abstraction means you never talk directly to pods - you always go through the service, which handles load balancing and health checking.

## Security Considerations

The exam values security-minded solutions. AKS supports Kubernetes Role-Based Access Control integrated with Azure AD, allowing you to control who can deploy applications and manage cluster resources. Understanding the concept is more important than memorizing specific role definitions. The key is knowing that you can use your existing Azure identities and apply the principle of least privilege.

Network policies control traffic between pods. In a zero-trust security model, you might use network policies to ensure that only specific pods can communicate with your database pods. This is an advanced topic, but be aware it exists for scenarios involving micro-segmentation and enhanced security.

For secrets management, never hardcode credentials. Use Kubernetes Secrets for sensitive data, and understand that Secrets are base64 encoded but not encrypted by default. For enterprise scenarios requiring additional security features like automatic rotation and audit logging, you integrate with Azure Key Vault. The exam might present scenarios where you need to recommend Key Vault integration for enhanced secrets management.

The principle of least privilege applies to container permissions as well. Avoid running containers as root when possible. Use security contexts to control what containers can do. While these are advanced topics, understanding that Kubernetes provides security controls at the container level is important for the exam.

## Cost Management and Best Practices

Understanding cost factors helps you make informed architectural decisions. With AKS, you're charged for the VM resources running as nodes - the Kubernetes control plane itself is free and managed by Azure. Larger VM sizes and more nodes increase costs. Load balancers and public IP addresses also incur charges. Storage used by persistent volumes adds to the cost.

You can reduce costs by choosing appropriate VM sizes for your workload, scaling down or stopping node pools when not needed, using spot instances for fault-tolerant workloads, and cleaning up unused resources like old persistent volumes. The exam might present cost optimization scenarios where you need to recommend ways to reduce spending while maintaining performance and availability.

Best practices for the exam include using multiple replicas for high availability, implementing health checks with liveness and readiness probes, setting resource requests and limits on containers, using namespaces to organize resources, implementing proper monitoring and alerting, and using infrastructure as code for cluster and application deployment.

## Common Exam Scenarios

You'll see scenarios involving deploying a multi-tier application to AKS. This typically includes a frontend web application exposed via a LoadBalancer service, a backend API accessed via a ClusterIP service, configuration stored in ConfigMaps, secrets stored in Kubernetes Secrets or Key Vault, and images pulled from Azure Container Registry. Understanding how all these components work together is crucial.

Another common scenario involves scaling and high availability. You need to explain or implement running multiple replicas of critical components, understanding how Kubernetes distributes pods across nodes for resilience, scaling the cluster to handle increased load, and using health probes to ensure traffic only goes to healthy pods.

Configuration update scenarios test your understanding of how Kubernetes handles changes. Modifying a ConfigMap doesn't automatically update running pods because configuration is loaded when pods start. To apply new configuration, you typically need to trigger a rollout that creates new pods with the updated configuration. However, updating a deployment spec like changing the container image does trigger a rolling update automatically, gradually replacing old pods with new ones.

## Preparation Recommendations

Practice creating clusters with different configurations. Deploy various applications including simple web apps, multi-container applications, and apps with persistent storage. Intentionally break things by deploying with incorrect configurations and learn to troubleshoot the resulting errors. This hands-on experience builds the intuition you need for exam questions.

Build command muscle memory by practicing CLI commands without looking at documentation. During the exam, you won't have time to look up every syntax detail. Understand YAML structure by hand-editing deployment files and observing how changes affect running applications. This practical experience is invaluable.

Focus on integration scenarios because that's where AKS questions typically appear. Understand how AKS connects to ACR, how it integrates with Azure Monitor, how it uses Azure AD for authentication, and how it leverages Azure networking. These integrations are what make AKS more than just Kubernetes - they're what make it an Azure service.

## Cleanup

When you're finished with exam preparation exercises, deleting the resource group removes everything - the AKS cluster, the managed MC resource group, and all associated resources. The no-wait flag lets the deletion proceed in the background so you can continue with other tasks. Proper cleanup is important not just for cost management but also for understanding resource lifecycles, which the exam sometimes tests.
